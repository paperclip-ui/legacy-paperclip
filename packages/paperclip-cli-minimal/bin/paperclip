#!/usr/bin/env node
const path = require("path");
const {build} = require("../lib/cli");

const argv = require("yargs")
.command("build [file-pattern]", "Compiles paperclip files to target language", yargs => {
  yargs
  .option("watch", desc("watch for changes"))
  .option("only", desc("Target files to generate"))
  .option("output", desc("Output directory"))
  .option("write", desc("Write compiled file"))
  .option("verbose", desc("Write verbose information"))
  .option("compiler", desc("Language compiler target (default is from paperclip.config.json if found)"))
  .option("definition", desc("Write typed definition type"))
}, argv => {
  build({
    cwd: process.cwd(),
    config: argv.config,
    write: argv.write,
    css: argv.css,
    output: argv.output,
    watch: argv.watch,
    definition: argv.definition,
    only: argv.only && argv.only.split(",").map(v => v.trim()),
    verbose: argv.verbose,
    dropPcExtension: argv.dropPcExtension,
    compilerName: argv.compiler,
    filePatterns: argv.filePattern
  })
}).argv;

function desc(description) {
  return {
    description
  }
}
