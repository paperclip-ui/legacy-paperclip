#!/usr/bin/env node
const {build, init, devStart} = require("../lib/cli");

const argv = require("yargs")
.command("build [file-pattern]", "Compiles paperclip files to target language", yargs => {
  yargs
  .option("watch", desc("watch for changes"))
  .option("drop-pc-extension", desc("Drops PC extension from compiled files"))
  .option("write", desc("Write compiled file"))
  .option("compiler", desc("Language compiler target (default is from paperclip.config.json if found)"))
  .option("definition", desc("Write typed definition type"))
}, argv => {
  build({
    config: argv.config,
    write: argv.write,
    watch: argv.watch,
    definition: argv.definition,
    dropPcExtension: argv.dropPcExtension,
    compilerName: argv.compiler,
    filePatterns: argv.filePattern
  })
})
.command("init", "Initialize new paperclip project", yargs => {
}, argv => {
  init();
})
.command("dev", "Starts the dev server", yargs => {
  yargs
  .option("port", desc("HTTP port to listen on"))
  .default("port", 4000)
}, argv => {
  devStart({
    port: argv.port,
    cwd: process.cwd()
  });
})
.argv;



function desc(description) {
  return {
    description
  }
}
