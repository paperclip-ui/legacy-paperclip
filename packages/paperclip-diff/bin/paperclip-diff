#!/usr/bin/env node

const { start, detectChanges, snapshot } = require("../lib");

const yargs = require("yargs");

yargs.command("snapshot", "Take snapshots of the current PR", yargs => {
  yargs
  .option("force", { description: "Force snapshot creation even if there are changes" });
}, async argv => {
  await snapshot({...argv, cwd: process.cwd() });
})
.command("detect-changes [branch]", "Show changes against a different branch", yargs => {
  yargs
  .option("watch", { description: "re-run when a PC file changes" })
  .option("html", { description: "Generate HTML report", default: true })
  .option("output", { description: "output directory for html", default: "pc-diff" })
  .option("open", { description: "open report after done generating" });
}, async argv => {
  await detectChanges({...argv, cwd: process.cwd() });
}).argv;